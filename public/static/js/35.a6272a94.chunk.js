"use strict";(self.webpackChunkenvelope_frontend=self.webpackChunkenvelope_frontend||[]).push([[35],{8676:function(e,n,r){r.d(n,{Z:function(){return s}});var t="ErrorCard_errorCard__JwCDV",a=r(184),s=function(e){return(0,a.jsx)("div",{className:t,children:e.children})}},9035:function(e,n,r){r.r(n),r.d(n,{default:function(){return A}});var t=r(1413),a=r(4165),s=r(5861),i=r(9439),c=r(2791),o=r(6871),l=r(2952),u=r(3108),d=r(9508),p=r(7831),f=r(3719),v="EnvelopeTransfer_transferContainer__zpyuH",h="EnvelopeTransfer_transferTitle__gnFNG",_="EnvelopeTransfer_transferSourceContainer__KG+jF",j="EnvelopeTransfer_destinationContainer__kvwT1",m="EnvelopeTransfer_formTransfer__zWHan",x="EnvelopeTransfer_inputSection__xUiuU",g="EnvelopeTransfer_transferContainerAction__KGrbe",b="EnvelopeTransfer_btnOk__QQBNz",T="EnvelopeTransfer_btnCancel__KpR5u",E="EnvelopeTransfer_errorMessage__d0rTf",k="EnvelopeTransfer_errorMessageBtn__O0vcj",N="EnvelopeTransfer_errorWrapper__IV7-+",C=r(1135),Z=r(8676),y=r(3168),F=r(8442),S=r(184),A=function(){var e=(0,y.$)(),n=e.t,r=e.i18n,A=(0,c.useContext)(u.V),w=(0,d.x)(),I=w.isLoading,D=w.error,B=w.sendRequest,O=(0,c.useState)(),U=(0,i.Z)(O,2),z=U[0],K=U[1],R=(0,c.useState)(),G=(0,i.Z)(R,2),H=G[0],P=G[1],q=(0,c.useState)(!1),J=(0,i.Z)(q,2),M=J[0],V=J[1],L=(0,o.UO)().envelopeId,Q=(0,o.s0)(),W=(0,l.cI)({mode:"onChange"}),X=W.register,$=W.handleSubmit;(0,c.useEffect)((function(){var e=new AbortController;try{var n=function(){var n=(0,s.Z)((0,a.Z)().mark((function n(){var r;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,B("https://envelope-project.herokuapp.com/api/1.0"+"/transactions/".concat(L,"/transfer"),e,"GET",null,{"Content-Type":"application/json",Authorization:"Bearer "+A.token});case 2:r=n.sent,K(r.sourceEnvelope),P(r.destinationEnvelopesArray);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}catch(D){}}),[B,A.token,L]);var Y,ee=function(e){e.preventDefault(),Q(-1)};if(D)return Y=JSON.parse(D),(0,S.jsx)("div",{className:N,children:(0,S.jsxs)(Z.Z,{children:[(0,S.jsx)("h2",{children:Y.serverMessage||Y.budget||Y.insufficientFunds||n("genericError")}),(0,S.jsx)(C.Z,{onClick:ee,children:n("goBack")})]})});if(I)return(0,S.jsx)(f.Z,{});var ne=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(n){var t,s,i,c,o,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=parseFloat(n.budget),s=parseFloat(z.budget),!(t>=s)){e.next=5;break}return V(!0),e.abrupt("return");case 5:return i="pt"===r.language?n.budget.replaceAll(".",""):n.budget.replaceAll(",",""),c="pt"===r.language?i.replace(",","."):parseFloat(i),o={destinationId:n.destinationId,budget:c},e.prev=8,l=new AbortController,e.next=12,B("https://envelope-project.herokuapp.com/api/1.0"+"/transactions/".concat(z.env_id,"/transfer"),l,"POST",JSON.stringify(o),{"Content-Type":"application/json",Authorization:"Bearer "+A.token,"X-CSRF-TOKEN":A.csurfTk,credentials:"include"});case 12:Q("/".concat(p.H.envelopes,"/").concat(p.H.userEnvelopes)),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(8);case 17:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(n){return e.apply(this,arguments)}}();if(z&&H){var re=(0,F.P)(z.budget,r.language),te=H.map((function(e){var n=(0,F.P)(e.budget,r.language);return(0,S.jsx)("option",{value:e.env_id,children:"".concat(e.title,": ").concat(n)},e.env_id)}));return(0,S.jsxs)("div",{className:v,children:[(0,S.jsx)("div",{className:h,children:(0,S.jsx)("h1",{children:n("transfer")})}),(0,S.jsxs)("div",{className:_,children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("h2",{children:n("source")}),(0,S.jsx)("h3",{children:z.title})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("h2",{children:n("availableFunds")}),(0,S.jsx)("h3",{children:re})]})]}),(0,S.jsxs)("div",{className:j,children:[(0,S.jsx)("h2",{children:n("envelopeDestination")}),(0,S.jsxs)("form",{onSubmit:$(ne),className:m,children:[(0,S.jsx)("label",{children:n("chooseDestination")}),(0,S.jsx)("select",(0,t.Z)((0,t.Z)({name:"Envelope Destination"},X("destinationId",{required:!0})),{},{children:te})),(0,S.jsxs)("div",{className:x,children:[(0,S.jsx)("p",{children:n("currency")}),(0,S.jsx)("input",(0,t.Z)({id:"valor",onKeyUp:function(){for(var e=document.getElementById("valor"),n=e.value.replace(/[^\d]+/gi,"").split("").reverse().join(""),t="",a="pt"===r.language?"##.###.###,##".split("").reverse().join(""):"##,###,###.##".split("").reverse().join(""),s=0,i=0;s<a.length&&i<n.length;)"#"!==a.charAt(s)?(t+=a.charAt(s),s++):(t+=n.charAt(i),i++,s++);e.value=t.split("").reverse().join("")},placeholder:n("amountToTransfer")},X("budget",{required:n("fieldNotEmpty")})))]}),(0,S.jsxs)("div",{className:g,children:[(0,S.jsx)(C.Z,{className:b,children:n("send")}),(0,S.jsx)(C.Z,{className:T,onClick:ee,children:n("cancel")})]})]}),M&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("p",{className:E,children:n("sourceInsufficientFunds")}),(0,S.jsx)(C.Z,{className:k,onClick:function(e){e.preventDefault(),V(!1)},children:"Ok"})]})]})]})}}},8442:function(e,n,r){r.d(n,{P:function(){return t}});var t=function(e,n){return("pt"===n?Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}):Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2})).format(e)}}}]);
//# sourceMappingURL=35.a6272a94.chunk.js.map